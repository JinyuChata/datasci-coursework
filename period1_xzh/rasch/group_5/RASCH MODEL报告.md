# RASCH  MODEL 

[toc]



​	我们为了研究学生在的编程能力的总体情况、试题难度的总体情况以及各道题目的质量情况,使用Rasch Model来分析。

## 什么是Rasch Model?

### 项目反应理论（IRT）

​	在了解Rasch模型之前,先介绍一下项目反应理论(Item Response Theory，IRT)。

> 项目反应理论是一系列心理统计学模型的总称。IRT是用来分析考试成绩或者问卷调查数据的数学模型。这些模型的目标是来确定的潜在特征（latent trait）是否可以通过测试题被反应出来，以及测试题和被测试者之间的互动关系。  ——维基百科

​	我们可以简单地理解为，项目反应理论是用来分析试题难度、人的解题能力及其相互关系的一系列理论，它的应用很广泛，SAT、TOFEL、GRE等考试都是以项目反应理论为基础构建的测验。而我们所使用的Rasch模型就是IRT系列模型中最基本的一个。

### Rasch模型的假设

Rasch模型有四个假设：

1. 单维性，测验中的每一个项目（item）都测量到一种共同的潜在特质。
2. 局部独立性，被测者在每一个项目（item）上的反应都是独立的。
3. 非速度测验假设，测验的进行是没有时间限制。
4. 知道——正确假设，如果被测者知道一道题目的正确答案，则必然答对。

### Rasch模型公式与试题特征曲线（ICC）

$$
P(U_i=1|\theta,b_i)=P_i(\theta)=\frac{e^{(\theta-b_i)}}{1+e^{(\theta-b_i)}}
\\Rasch Model

\\b_i:试题难度参数(item\ \ difficulty\ \ parameter)
\\\theta:能力参数(ability)
$$

​	公式(1)即Rasch模型的核心公式，它表示能力参数为$\theta$的人在做一道难度参数为$b_i$的题目的时候答对的概率。

​	该公式的图像是一条逻辑斯蒂曲线(Logistic Curve),我们称之为试题特征曲线(Item Characteristic Curve, ICC)

<img src="https://spring-security.oss-cn-beijing.aliyuncs.com/20200709202023.PNG" style="zoom:67%;" />

​																			图1,ICC Example	

​		在ICC图中, $\theta=b_i$时,答对的概率刚好是0.5;	$\theta-b_i>0$,则答对几率大于0.5;	$\theta-b_i<0$,则答对几率小于0.5。所以我们看到ICC曲线的理想状态是S形，当人的能力$\theta$增加时，他所能够应对的试题难度会逐渐提升,但是一开始这种提升是不明显的(图中曲线斜率较小);之后再中期这种提升变得明显(图中曲线斜率较大);当他的能力超过一个较大值时,这种难度的提升再次变得不明显(图中曲线斜率较小)。

### Rasch Model的估计原理

​	Rasch Model使用极大似然估计的方法。我们以估计学生能力来解释其估计方法，估计试题难度的部分放在附录（TODO）。

​	首先我们需要有一个前提，那就是各个试题互不影响，各个学生之间也互不影响。

​	我们暂时先假设每道题的难度系数$b_i$是已知的。

​	我们考虑公式：
$$
P_i(\theta)=\frac{e^{(\theta-b_i)}}{1+e^{(\theta-b_i)}}
$$
​	

​	我们使用$u_i$来表示一个人是否答对一道题：
$$
U_i=u_i=\begin{equation}
\left\{
             \begin{array}{lr}
             1, correct\ \    response&  \\
              & i=1,2,...,n\\
             0, incorrect \ response &  
             \end{array}
\right.
\end{equation}
$$
​	

​	使用$Q_i$来表示一个人答错一道题的概率,显然：
$$
Q_i(\theta)=1-P_i(\theta)=\frac{1}{1+e^{(\theta-b_i)}}
$$


​	于是,在某个学生的能力$\theta$的条件下,他答对第$i$道试题的概率可以如下表示：
$$
\begin{equation}
P(U_i|\theta)
\begin{split}
&=
\left\{ 
             \begin{array}{lr}
             P_i(\theta), \ \ \ correct\ \    response (u_i=1)&  \\
             
             1-P_i(\theta), incorrect \ \ response (u_i=0)  
             \end{array}
            
            
             
\right.
\\&=P_i^{u_i}Q_i^{1-u_i},i=1,2,...,n
\end{split}
\end{equation}
$$
​	

因为试题并不会互相影响,所以：
$$
\begin{equation}
\begin{split}
P(U_1,U_2,...,U_n|\theta) &= P(U_1|\theta)P(U_2|\theta)...P(U_n|\theta)
\\&=\prod_{i=1}^{n}P_i^{u_i}Q_i^{1-u_i}
\end{split}
\end{equation}
$$


我们取对数似然函数：
$$
\begin{equation}
\begin{split}
L&=\ln P(U_1,U_2,...,U_n|\theta)

\\&=\ln P(U_1|\theta)+\ln P(U_2|\theta)+...+\ln P(U_n|\theta)

\\&=\sum_{i=1}^{n}(\ln P_i^{u_i}+\ln Q_i^{1-u_i})
\\&=\sum_{i=1}^{n}(u_i\ln P_i+(1-u_i)\ln Q_i)


\end{split}
\end{equation}
$$


​	接下去,我们只要把该同学做每道题得到的$u_i$与$b_i$代入公式（7）的右边，就可以发现L只与$\theta$有关，他们的关系及关系图象如下：
$$
\hat{\theta} = argmax \ L
$$
<img src="https://spring-security.oss-cn-beijing.aliyuncs.com/20200709205042.png" alt="image-20200709205041012" style="zoom:67%;" />

​																				图2，$L$与$\theta$关系

​	于是我们只要找到图2最高点，他对应的横坐标就是学生能力$\theta$的估计值。

​	//TODO 删掉下面一段？

​	在这里我们解释了已知难度参数$b_i $求能力参数$\theta $的情况，这里面只有一个参数$\theta $；在附录中我们解释了已知能力参数$\theta_i $求难度参数$b$的情况,在那里只有一个参数$b$。这两个解释中的模型被称为1参数逻辑斯蒂模型（One-parameter Logistic Model,1PL）。我们需要使用的是二参数的



## 为什么使用Rasch Model?

### Rasch Model本身的优势

​	Rasch Model应用如此广泛，是因为他本身有很多优势：

1. 数据有线性的特质，Rasch模型可以把非线性的数据转换成为具有等距意义的“logit scale”数据，从而使客观的测量成为可能。
2. 参数分离，客观测量的参数分离要求“题目难度的标定必定独立于被试样本的分布，对个体能力的测量必须独立于题目的难度分布”。而由Rasch model的估计原理可知，这两个要求是可以被满足的

3. 个体和题目公用一把尺，Rasch模型通过对数转换，将个体和题目在同一单维度尺上进行标定。因此个体与个体之间、题目与题目之间、个体与题目之间可以方便地进行比较。

### 我们获得数据样本的适用性

​	我们从老师那里拿到地数据是符合Rasch模型的要求的。

​	首先，每一个同学做一道题是否通过是最核心的一个数据，这个可以由原始数据中$final\_score$来展示。如果$final\_score$为100则视为通过该道题目测试；反之则视为未通过。

​	第二，尽管所有的同学被分成了五个组,每个组有50-60个人,我们在分析的时候不能进行整个总体的分析，但是我们分析的时候也可以根据这样的分组来做。

​	第三，我们可以假设每个同学答题是互不影响的，每道试题也是互不影响的。尽管这可能过于理想化，但是我们相信不合要求的数据是极少的，而我们要研究总体的情况，因此可以认为极少数的不合规不会影响总体的分析与判断。

​	第四，我们不仅可以提取处分组的数据，还可以提取出分类的数据（如数组，字符串，图结构等），这样我们可以不仅仅分析所有类别题目总体的情况，还可以分析每个类别的情况。



## 实践：使用Rasch Model 分析python编程中题目的难度和学生的能力

### 提取数据 （/TODO 这个要写吗？）

​	使用python得出每个小组的试题——个人的csv文件，代码见附录（TODO）。

### 计算参数与绘制图表的方法

​	因为R语言中对于IRT套件的支持比较丰富，因此我们选用R语言来进行计算与绘图。（详细代码见附录TODO）

​	因为分成了五组数据，并且数据量比较大，我门不会在文中列出全部的参数和图表，如果想要查看可以见附录（或者GitHub仓库 TODO），我们仅仅拿出一些典型的数据与图表来进行研究分析。



### ICC

#### 单条ICC图

​	我们来看一些第一组中题目的单条ICC图，可以观察出一些有意思的结论：

- 题目一：

<img src="https://spring-security.oss-cn-beijing.aliyuncs.com/20200709214622.png" alt="image-20200709214621254" style="zoom: 45%;" />

​	这是第一组的一道题目，题目编号是2779，类别是线性表。

​	图中的黑色折线是同学们实际做题的情况，蓝色曲线是通过Rasch Model拟合出来的曲线。我们可以看到黑色和蓝色的线总体上是比较接近的，这说明我们的分析是比较有效的。另外，拟合曲线也很接近于一条S形的逻辑斯蒂曲线，这说明这道题是质量比较高的，有一定的区分度。我们也可以看出当能力参数比较小时，黑色折现在蓝色曲线下面，这说明此时rasch模型是高估了学生的能力；而当能力参数变大时，rasch模型却低估了学生能力。

​	而在模型中，我们计算得到的这道题的难度参数为-0.9881，是一道中等难度的题目。

- 题目二：

<img src="https://spring-security.oss-cn-beijing.aliyuncs.com/20200710092946.png" alt="image-20200710092942735" style="zoom: 50%;" />

​	这依然是第一组的一道题目，题目编号是2734，类别是树结构。

​	我们可以明显地看到，表示实际的黑色折线和拟合的蓝色曲线并不是特别接近，说明rasch model的拟合在这道题并不是特别准确，但是我们依然可以通过这张图得到很多信息。拟合曲线依然很像一条逻辑斯蒂曲线，这道题依然是区分度比较高的，因此质量比较不错。我们也可以看到，当能力参数小于0时，它的增加并不能明显提高学生答出此题的可能性（当$ability$较小时，曲线斜率增长较慢）。

​	总体上面这张图中的拟合曲线明显低于题目一的拟合曲线，说明总体上学生做出这道题的概率低于做出题目一的概率。而在模型中，我们计算出的难度系数为0.4901，明显大于题目一的难度系数，因而我们从图上观察出的结论时正确的。

- 题目三：

<img src="https://spring-security.oss-cn-beijing.aliyuncs.com/20200710094446.png" alt="image-20200710094444130" style="zoom: 50%;" />

​														

​	这是第一组的一道题目,编号是2930,类别是数组。

​	我们可以发现，这道题并没有很高的区分度，因为能力比较低的学生已经可以有接近0.5的概率答对该题，而能力参数为0的同学已经有接近1的概率去完成作答，因此这道题质量不是很高。

​	另外，与上面两张图比较来看，题目三的曲线明显是高于题目一和题目二的，因此我们认为这道题是相对简单的。事实上，我们得出的难度系数为-2.9545，这说明题目三是一道很简单的题目。

​	我们的R语言代码通过tam包可以获得每道题目的单条ICC图，发现大多数题目是符合逻辑斯蒂曲线的，它们有较高的质量，但是限于篇幅，我们在这里就不放过多图片。

#### 联合ICC图（jointICC）

​	我们在画图的时候可以把多条ICC曲线放到同一张图里面，这样我们观察题目集合的特征时，可以更加直观。这种图片我们称之为联合ICC（jointICC）。

​	我们依然以第一组为例。我先把第一组八类题目各自的联合ICC图拼接到一起,如下所示:

<img src="upload/image-20200710111454392.png" alt="image-20200710111454392" style="zoom:100%;" />

​		我们可以发现,每种类别的题目难度分布都很完整(曲线接近x轴说明题目难，曲线远离x轴说明题目简单),也就是说,从简单到困难的题目在每种类别里面都有体现。这说明我们题库中的题目设计是很良好的，没有出现不合理的题目设计（比如图结构的题目都特别难，数字操作的题目都特别简单这样的不合理）。

​	另外，我们可以发现每种类别的题目分布都是类橄榄型，简单和困难题较少，中等难度的题比较多，这样可以增加学生能力的区分度，因为简单的题目可能所有人都会答对，困难的题目可能所有人都会答错，而中等难度的题目可以拉开差距，形成区分。而如果只比较简单题与难题的数量，可以看出简单题比难题多。



​	我们可以再聚焦看第一组树类别的联合ICC图。

<img src="https://spring-security.oss-cn-beijing.aliyuncs.com/20200710122845.png" alt="image-20200710122844526" style="zoom:67%;" />

​	我们可以发现，第一组的树类别的题目题量是足够的，大部分题目都是中等难度，他们的曲线是S形的逻辑斯蒂曲线。而有三道题比较偏上（远离x轴），这三道题我们可以归结为“简单题”或者说“送分题”，他们相对来说是比较容易被解答的。综合来看，第一组树类别的题目质量是很高的。



​	其他各组的题目联合分布图大致情况也类似第一组，由于篇幅原因就不放在此处。



### 难度系数

​	除了图片上通过视觉直观的观察之外，我们还需要查看计算得到的参数来进行题目难度与质量的分析。

​	下面是一张我们rasch模型计算得到的平均难度系数表格。

|        | all  | array | graph | linear | number | searching | sorting | string | tree |
| ------ | ---- | ----- | ----- | ------ | ------ | --------- | ------- | ------ | ---- |
| group1 | -1.3 | -1.1  | -1.1  | -1.4   | -2.2   | -1.9      | -3.0    | -0.8   | -1.3 |
| group2 | -1.2 | -2.2  | -1.1  | -2.4   | -2.9   | -2.3      | -2.6    | -1.5   | -0.3 |
| group3 | -2.6 | -2.8  | -1.4  | -3.1   | -3.8   | -3.6      | -4.2    | -3.1   | -1.8 |
| group4 | -1.7 | -2.7  | -0.7  | -1.9   | -2.0   | -2.4      | -2.6    | -2.7   | -1.3 |
| group5 | -1.7 | -2.6  | -0.4  | -2.1   | -1.9   | -2.9      | -2.5    | -1.8   | -1.0 |

​	接下来是我们根据难度系数表格画出来的折线图：

<img src="https://spring-security.oss-cn-beijing.aliyuncs.com/20200710125445.png" alt="image-20200710125443444" style="zoom: 67%;" />

#### 前提假设

​	我们假设每个组的同学的实力都是差不多的。在分组的时候是按照学号来分的，学好的分布是比较均匀的，因而我们有理由假设每个组的同学实力差不多。

#### 组内比较

​	首先我们先进行组内的比较。

​	第一组：我们可以看到数组类别、图类别、字符串类别、和树类别的题目总体是比较困难的（也可以认为是第一组同学在这些方面不太擅长），而数字类别和排序算法比较简单（也可以认为是第一组同学在这些方面比较擅长）。

​	第二组：图类别和树类别的题目总体是比较困难的（也可以认为是第二组同学在这些方面不太擅长），而数字类别和排序算法比较简单（也可以认为是第二组同学在这些方面比较擅长）。

​	第三组：图类别和树类别的题目总体是比较困难的（也可以认为是第三组同学在这些方面不太擅长），而数字类别和排序算法比较简单（也可以认为是第三组同学在这些方面比较擅长）。

​	第四组：我们可以看到图类别和树类别的题目总体是比较困难的（也可以认为是第四组同学在这些方面不太擅长），而数组类别和字符串类别比较简单（也可以认为是第四组同学在这些方面比较擅长）。

​	第五组：我们可以看到图类别和树类别的题目总体是比较困难的（也可以认为是第四组同学在这些方面不太擅长），而数组类别和查找算法比较简单（也可以认为是第四组同学在这些方面比较擅长）。

​	每一组组内的分析来看，每个组题目难度分布并不是完全相同的，比如第一组的数组类别比较困难，而第四组和第五组的数组类别却比较简单。我们认为，这种差异更应该被归结为客观因素，即题目难度的区别，而非主观的同学能力的不同，因为我们可以假定每个组同学的实力是差不多的。

#### 组间分析

​	接下来我们进行组间的分析研究。

​	我们可以明显地看到，第三组的折线是低于其他四组的。这说明第三组的题目相对而言是比较简单的（当然我们可以理解为第三组的同学实力比较强，完成度比较高。但这是主观的因素，我们更倾向于相信客观因素，即题目难度）。而其他四组的折线是差不多的、有交错的，这可以理解为其他四组题目的难度差不太多。

​	整体来看，树结构和图结构的题目是相对比较困难的，同学们很难解答这些题目。我们会建议加强同学们在这方面的练习。而数组、数字操作的题目相对而言比较简单，同学们较为容易解答这些题目。





TODO：分析wrightmap图，总体的和各类

### WrightMap ( Person-Item Map)

#### 介绍WrightMap

​	WrightMap(怀特图),也叫Person-Item Map(试题-人图),是为了纪念在Rasch模型测量中做出卓越贡献的本怀特（Ben Wright）而命名的。这种图可以按照比例显示被试者的能力和试题的难度，被试者能力和试题难度被（水平或者垂直地）分隔开，它被广泛应用于各种响应模型中。

#### 实践中使用WrightMap

​	我们使用R语言来绘制WrightMap。

​	下面的图片是第一组被试者和第一组所有题目的怀特图：

![image-20200711111256083](https://spring-security.oss-cn-beijing.aliyuncs.com/20200711133326.png)

​	上面的柱形是被试者能力的分布，下面网格线中的一系列点是试题难度的分布。点或者柱形越靠右边，说明试题难度越大或者被试者能力越高。如果一个柱形和一系列点在同一条竖直的铅垂线上，说明柱形对应的被试者做出那些点对应的试题的概率为0.5。通过分析第一组所有题目的WrightMap，我们可以发现：

1. 试题分布为橄榄型，以中等难度试题为主，困难和简单题较少，这也与我们通过前面的分析得出的结论一致。
2. 在模型估算中，许多试题难度相近，这很可能是由于本身数据质量决定的。
3. 同学能力分布也呈现橄榄型，大部分同学的能力都在中等偏上的程度，他们有大于0.5的概率能答出大多数题目；有一小部分同学的能力特别差，连相对简单的题目也无法解答；还有一部分同学的能力特别强，有超过0.5的概率能答出所有题目。
4. 柱形分步较广，说明测试出来的学生能力区分度很高，这说明试题总体质量较高。这也与我们之前得出的结论一致。

其他小组的情况与第一组相类似，我们在这里只放出WrightMap，不再赘述观察到的结论。如下（分别为第二组，第三组，第四组，第五组）：

![image-20200711111643918](https://spring-security.oss-cn-beijing.aliyuncs.com/20200711111646.png)





### Rasch Model研究结论

下面是我们使用Rasch Model研究数据得到的结论总结：  

1. 我们通过观察每道题目各自的ICC曲线，发现大多数题目符合逻辑斯蒂曲线，有很高的题目质量，区分度高。

2. 我们通过观察联合ICC图（jointICC），发现每组每种类别的题目难度分布都很完整，从简单到困难的题目在每种类别里面都有体现；每组每种类别的题目分布都呈现橄榄型，简单和困难题目较少，中等难度的题目比较多，这有助于拉开差距，形成区分。
3. 我们使用rasch模型计算出每个组每种类别的题目难度参数，形成一个表格，并根据表格画出折线图，发现每个组的题目难度分布并不完全相同，比如第一组的数组类别比较困难，而第四组和第五组的数组类别却比较简单。我们把这中差异归结为客观因素，即题目难度。我们还发现第三组的题目整体难度低于其他四组。
4. 同样使用第三点得到的表格和折线图，我们发现树结构和图结构的题目相对比较困难，同学们很难解答这些题目。而数组、数字操作的题目相对而言比较简单，同学们较为容易解答这些题目。
5. 我们使用R语言得到了每组的WrightMap。我们发现一些已经被印证过的结论：试题分布为橄榄型，以中等难度试题为主，困难和简单题较少；WrightMao中代表学生的柱形分步较广，说明测试出来的学生能力区分度很高，这说明试题总体质量较高。
6. 通过第五点中的WrightMap，我们发现同学能力分布也呈现橄榄型，大部分同学的能力都在中等偏上的程度，他们有大于0.5的概率能答出大多数题目；有一小部分同学的能力特别差，连相对简单的题目也无法解答；还有一部分同学的能力特别强，有超过0.5的概率能答出所有题目。